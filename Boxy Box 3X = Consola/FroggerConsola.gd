extends "res://ServidorSocket.gd"


var lastmove_x = 25
var lastmove_y = 25



var x = 25
var y = 25

#este es pacman
var frog = [
			[1,3],[0,0],[1,3],[0,0],[1,3],
			[0,0],[1,3],[1,2],[1,3],[0,0],
			[0,0],[1,3],[1,3],[1,2],[0,0],
			[1,3],[1,3],[1,3],[1,3],[1,3],
			[1,3],[0,0],[0,0],[0,0],[1,3]
			]


var mapa = [[6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 7, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 7, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 4, 5, 8, 6, 4, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 4, 5, 8, 6, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 7, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 6, 6, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 7, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 6, 4, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 5, 5, 5, 4, 15, 15, 15, 15, 15, 15, 15, 15, 15, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 5, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 4, 15, 15, 15, 15, 15, 15, 15, 15, 15, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 4, 5, 5, 16, 5, 5, 9, 5, 8, 6, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 13, 13, 13, 13, 6], [6, 13, 13, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 8, 6, 4, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 13, 13, 13, 13, 6], [6, 13, 13, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 6, 6, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 11, 12, 11, 12, 11, 6], [12, 11, 12, 11, 12, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 6, 6, 5, 5, 4, 6, 6, 6, 6, 6, 7, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 12, 11, 12, 11, 12, 6], [11, 12, 11, 12, 11, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 6, 5, 5, 4, 6, 6, 6, 6, 6, 7, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 11, 12, 11, 12, 11, 6], [12, 11, 12, 11, 12, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 6, 4, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 12, 11, 12, 11, 12, 6], [11, 12, 11, 12, 11, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 11, 12, 11, 12, 11, 6], [12, 11, 12, 11, 12, 13, 13, 1, 1, 1, 1, 2, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 7, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 12, 11, 12, 11, 12, 6], [11, 12, 11, 12, 11, 13, 13, 1, 1, 1, 2, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 7, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 11, 12, 11, 12, 11, 6], [12, 11, 12, 11, 12, 13, 13, 1, 1, 1, 1, 2, 1, 1, 1, 4, 5, 8, 6, 4, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 12, 11, 12, 11, 12, 6], [11, 12, 11, 12, 11, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 8, 6, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 11, 12, 11, 12, 11, 6], [6, 13, 13, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 6, 6, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 13, 13, 13, 13, 6], [6, 13, 13, 13, 13, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 6, 4, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 13, 13, 13, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 4, 15, 15, 15, 15, 15, 15, 15, 15, 15, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 5, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 16, 5, 5, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 4, 15, 15, 15, 15, 15, 15, 15, 15, 15, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 16, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 8, 6, 4, 5, 4, 6, 6, 7, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 8, 6, 5, 5, 4, 6, 6, 7, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 4, 5, 5, 5, 5, 5, 9, 5, 6, 6, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 7, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 6, 4, 5, 4, 6, 6, 6, 6, 6, 6, 6, 7, 6, 4, 5, 5, 5, 16, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 5, 5, 16, 5, 5, 9, 5, 5, 5, 5, 5, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5, 5, 4, 12, 12, 12, 13, 6], [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6]]

func _ready():
	_init()
	socketpantalla.put_var(["frogger",frog,mapa])
	socketpantalla.put_var(["moverse",x,y,11,6])


func _process(_delta):
	#revisamos si ya llegamos a la meta
	if x <= 30 and x >= 23 and y <= 4 and y <= 1:
		socketpantalla.put_var(["set_fondo",get_parent().default])
		quit()
		
	if(socket.get_available_packet_count() > 0):
			var data = socket.get_var()

			if(data[0] == "quit"):
				socketpantalla.put_var(["set_fondo",get_parent().default])
				yield(get_tree().create_timer(2), "timeout")
				quit()
			
			#recibir confirmacion de movimiento
			if (data[0] == "colision"):
				arreglar_pos()
				
			#recibimos los inputs
			if (data[0] == "arriba"):
				mover_personaje(1)
			elif (data[0] == "abajo"):
				mover_personaje(2)
			elif (data[0] == "izquierda"):
				mover_personaje(3)
			elif (data[0] == "derecha"):
				mover_personaje(4)
	



func mover_personaje(dir):
	if dir ==1:
		lastmove_x = x
		lastmove_y = y
		y -= 3
	elif dir == 2:
		lastmove_x = x
		lastmove_y = y
		y += 3
	elif dir == 3:
		lastmove_x = x
		lastmove_y = y
		x += 3
	elif dir == 4:
		lastmove_x = x
		lastmove_y = y
		x -= 3
	else:
		return
	socketpantalla.put_var(["moverse",x,y,11,6]) #11 color de bolas y 6 de colision


func arreglar_pos():
	x = 24
	y = 45
	socketpantalla.put_var(["moverse",x,y,11,6])
	pass

